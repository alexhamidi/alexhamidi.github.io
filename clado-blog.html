<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" hrelf="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
  <link rel="manifest" href="favicon/site.webmanifest">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
  <title>building SoTA people search @ Clado - Alex Hamidi</title>
</head>

<body class="flex flex-col items-center text-gray-900 font-mono overflow-x-hidden bg-[#fcfcfa] color-[#121212]">

  <div class="flex flex-col gap-8 max-w-[700px] px-[20px] mb-12">

    <div class="flex items-center justify-between mt-8 mb-4">
      <a href="/" class="text-sm text-gray-600 hover:text-gray-900 underline">← back to home</a>
      <div class="text-xs text-gray-500">August 2024</div>
    </div>

    <article class="blog-content text-sm">
      <h1 class="text-3xl font-bold mb-6">building SoTA people search @ Clado</h1>
<h3 class="text-xl font-semibold mt-8 mb-4">Background</h3>
<p class="mb-4 leading-relaxed">A few months ago, I joined <a href="https://clado.ai/" class="underline text-gray-900 transition-all duration-500 hover:text-gray-50 hover:bg-gray-700 px-0.5">Clado</a> as a software engineer. My internship has since ended, but I wanted to share a bit about some of my biggest contributions to clado’s people search engine, which performs <a href="https://pbs.twimg.com/media/GwLWi2lWoAAGpOc?format=jpg&name=medium" class="underline text-gray-900 transition-all duration-500 hover:text-gray-50 hover:bg-gray-700 px-0.5">better than all competitors</a> on <a href="https://pearch.ai/" class="underline text-gray-900 transition-all duration-500 hover:text-gray-50 hover:bg-gray-700 px-0.5">pearch.ai’</a>s sourcing <a href="https://arxiv.org/pdf/2504.02463" class="underline text-gray-900 transition-all duration-500 hover:text-gray-50 hover:bg-gray-700 px-0.5">benchmark</a>.</p>
<p class="mb-4 leading-relaxed">As a primer: Our search is criteria based, and users can search through 100+ fields across 1B+ profiles in a single query. We achieve this at scale by decomposing the search problem into two parts:</p>
<ol class="list-decimal pl-6 mb-4 space-y-2"><li>generate a database query based on the user’s input</li><li>filter returned profiles in parallel using large language models.</li></ol>
<h3 class="text-xl font-semibold mt-8 mb-4">Creating a new Query Language</h3>
<p class="mb-4 leading-relaxed">Around 1 week in, we migrated our database from a MySQL to OpenSearch. After running a set of evals, I found that most open models (in the 18b-32b parameter range) struggled to generate valid OpenSearch queries, primarily because of how much more verbose and complex it was than SQL.</p>
<p class="mb-4 leading-relaxed">For reference, here is an SQL query corresponding to the search “Find me software engineers in SF”:</p>
<pre class="bg-gray-50 border border-gray-200 rounded-lg p-4 overflow-x-auto my-4 text-sm"><code class="language-sql">SELECT *
FROM people
WHERE 
  ( -- this is "criteria 1"
    location LIKE '%SF%'
    OR location LIKE '%San Francisco%' 
  )
  AND ( -- this is "criteria 2"
    current_company_title LIKE '%Software Engineer%'
    OR past_company_title LIKE '%Software Engineer%'
  );
</code></pre>
<p class="mb-4 leading-relaxed">And here is the OpenSearch equivalent:</p>
<pre class="bg-gray-50 border border-gray-200 rounded-lg p-4 overflow-x-auto my-4 text-sm"><code class="language-json">{
  "query": {
    "bool": {
      "must": [
        {
          "bool": { // this is "criteria 1"
            "should": [
              { "match_phrase": { "location": "SF" } },
              { "match_phrase": { "location": "San Francisco" } }
            ],
            "minimum_should_match": 1
          }
        }
      ],
      // this is "criteria 1"
      "should": [
        { "match_phrase": { "current_company_title": "Software Engineer" } },
        { "match_phrase": { "past_company_title": "Software Engineer" } }
      ],
      "minimum_should_match": 1
    }
  }
}
</code></pre>
<p class="mb-4 leading-relaxed">Opensearch queries are 4x more tokens on average, which translated directly to inference costs.</p>
<p class="mb-4 leading-relaxed">With these problems, I realized something exciting: I could create a *completely new* language that was optimized for our criteria-based searches, and then interpret that to any query language, whether it be SQL, OpenSearch, etc.</p>
<p class="mb-4 leading-relaxed">We would no longer need to retrain models for each new language, and I could experime</p>
<p class="mb-4 leading-relaxed">The language had a few requirements:</p>
<ol class="list-decimal pl-6 mb-4 space-y-2"><li>*maximally* *expressive*, meaning it could represent ANY possible query a user might make</li><li>*maximally concise* - to reduce token spend, inference time, and failure probability</li><li>python based - to make it easier to parse</li></ol>
<p class="mb-4 leading-relaxed">Now, I know what you may be thinking. the strong *priors* of the model would . its basic intu</p>
<h3 class="text-xl font-semibold mt-8 mb-4">Postraining</h3>
<p class="mb-4 leading-relaxed">**how posttrainnig**</p>
<p class="mb-4 leading-relaxed">as a brie overview, lets talk about</p>
<p class="mb-4 leading-relaxed">SFT means</p>
<p class="mb-4 leading-relaxed">RL, is just .. you provide a reward functoin</p>
<p class="mb-4 leading-relaxed">Going into …, I had no exprctations ofwhat</p>
<p class="mb-4 leading-relaxed">The obcious downside of .. is htthat ..</p>
<p class="mb-4 leading-relaxed">The LLM has likely seen millions if not billionso f example of sQL in its training cop</p>
<p class="mb-4 leading-relaxed">was simple - jut LLM as a judge. we used</p>
<p class="mb-4 leading-relaxed"><<talk about novel reward function>></p>
<pre class="bg-gray-50 border border-gray-200 rounded-lg p-4 overflow-x-auto my-4 text-sm"><code class="language-latex">quantityff = tanhsf
ff
</code></pre>
<p class="mb-4 leading-relaxed">in order to prevent bias toward:</p>
<pre class="bg-gray-50 border border-gray-200 rounded-lg p-4 overflow-x-auto my-4 text-sm"><code class="language-jsx">....
</code></pre>
<p class="mb-4 leading-relaxed">tabase query based on the user’s input</p>
<p class="mb-4 leading-relaxed">at this point, we ha already 2 separate posttrained models, and decided to switch into to ElasticSearch since it’s full text search was stronger & faster than SQL. However, this would mean. to make sure we</p>
<p class="mb-4 leading-relaxed">however, we found that this is *not* the case with small models you are posttraining. this was one of the most important realizations i had at clado.</p>
<p class="mb-4 leading-relaxed">were dual. little segue to talk about RL</p>
<p class="mb-4 leading-relaxed">lower hallucination</p>
<p class="mb-4 leading-relaxed">- fine tuning, deciding reward function (make it sound as mathy/research as possible)</p>
<p class="mb-4 leading-relaxed">building</p>
<ul class="list-disc pl-6 mb-4 space-y-2"><li>eval model</li><li>final ree</li></ul>
<p class="mb-4 leading-relaxed">now, … . we suggest, and stay posted for any BIg updates for the clado team :)</p>
<h3 class="text-xl font-semibold mt-8 mb-4">Reflecition</h3>
<p class="mb-4 leading-relaxed">That you can use RL to teach small language models to do arbitrary tasks well.</p>
<p class="mb-4 leading-relaxed">This is particularly exciting because</p>
<p class="mb-4 leading-relaxed">citations:</p>
    </article>

    <div class="flex items-center justify-between mt-8 pt-8 border-t border-gray-200">
      <div class="text-sm text-gray-600">
        Written by <a href="/" class="underline hover:text-gray-900">Alex Hamidi</a>
      </div>
      <div class="flex gap-4 text-sm">
        <a href="https://twitter.com/ahamidi_" class="text-gray-600 hover:text-gray-900 underline">Twitter</a>
        <a href="https://github.com/alexhamidi/" class="text-gray-600 hover:text-gray-900 underline">GitHub</a>
      </div>
    </div>

  </div>

</body>

</html>