<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="../favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../favicon/favicon-16x16.png">
  <link rel="icon" href="../favicon/favicon.ico">
  <link rel="manifest" href="../favicon/site.webmanifest">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$'], ['\[', '\]']]
      }
    };
  </script>
  <title>Building Umari - Alex Hamidi</title>
</head>

<body class="flex flex-col items-center text-gray-900 font-mono overflow-x-hidden bg-[#fcfcfa] color-[#121212]">

  <div class="flex flex-col gap-8 max-w-[700px] px-[20px] mb-12">

    <div class="flex items-center justify-between mt-8 mb-4">
      <a href="/" class="text-sm text-gray-600 hover:text-gray-900 underline">← back to home</a>
      <div class="text-xs text-gray-500">October 2025</div>
    </div>

    <article class="blog-content text-sm">
      <h1 class="text-3xl font-bold mb-6">Building Umari</h1>

      <h3 class="text-xl font-semibold mt-8 mb-4">Motivation</h3>

      <p class="mb-4 leading-relaxed">Reasoning models excel at planning—decomposing "book a flight to NYC" into search, filter, and purchase steps. But executing these plans requires grounding actions to pixel coordinates, which is fundamentally different.</p>

      <p class="mb-4 leading-relaxed">Planning is discrete and semantic: decide <em>what</em> to click. Grounding is continuous and spatial: find <em>where</em> to click. Using a reasoning model for both wastes compute on the grounding task, which doesn't benefit from chain-of-thought.</p>

      <p class="mb-4 leading-relaxed">The cost compounds quickly. Vision models process screenshots as tiles—a 1920×1080 screen is ~1000 tokens. For a 100-step workflow, this costs $3-9 without caching. At scale, repeatedly calling a reasoning model for coordinate prediction becomes prohibitively expensive.</p>

      <h3 class="text-xl font-semibold mt-8 mb-4">Architecture</h3>

      <p class="mb-4 leading-relaxed">The system decomposes into two specialized models:</p>

      <ol class="list-decimal pl-6 mb-4 space-y-2">
        <li><strong>Planning:</strong> Vision-language model generates semantic actions from screenshots</li>
        <li><strong>Grounding:</strong> Specialized model maps semantic actions to pixel coordinates</li>
      </ol>

      <p class="mb-4 leading-relaxed">Given a screenshot <span class="math-inline">$s_t$</span> and history <span class="math-inline">$h_t = \{(s_i, a_i)\}_{i=0}^{t-1}$</span>, the planner outputs action <span class="math-inline">$a_t$</span>:</p>

      <div class=" my-6 bg-gray-50 p-4 border border-gray-200 rounded-lg text-center">$
a_t = \pi_{\text{plan}}(s_t, h_t)
$</div>

      <p class="mb-4 leading-relaxed">The grounding model converts semantic actions to coordinates:</p>

      <div class=" my-6 bg-gray-50 p-4 border border-gray-200 rounded-lg text-center">$
(x, y) = \pi_{\text{ground}}(s_t, a_t)
$</div>

      <p class="mb-4 leading-relaxed">Example output:</p>

      <pre class="bg-gray-50 border border-gray-200 rounded-lg p-4 overflow-x-auto my-4 text-sm"><code class="language-json">{
  "action": "click",
  "target": "Submit button",
  "coordinates": [834, 672],
  "confidence": 0.94
}
</code></pre>

      <h3 class="text-xl font-semibold mt-8 mb-4">Cost Analysis</h3>

      <p class="mb-4 leading-relaxed">Vision-language models tile screenshots for processing. A 1920×1080 screen generates 6 tiles at 170 tokens each:</p>

      <div class=" my-6 bg-gray-50 p-4 border border-gray-200 rounded-lg text-center">$
T_{\text{image}} = \lceil \frac{w}{512} \rceil \times \lceil \frac{h}{512} \rceil \times 170
$</div>

      <p class="mb-4 leading-relaxed">For a 100-step workflow:</p>

      <table class="min-w-full border-collapse border border-gray-300 my-6 text-sm">
        <thead class="bg-gray-50">
          <tr>
            <th class="border border-gray-300 px-4 py-2 font-semibold text-left">Metric</th>
            <th class="border border-gray-300 px-4 py-2 font-semibold text-left">Without Caching</th>
            <th class="border border-gray-300 px-4 py-2 font-semibold text-left">With Caching</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="border border-gray-300 px-4 py-2">Cost</td>
            <td class="border border-gray-300 px-4 py-2">$3.20–$9.40</td>
            <td class="border border-gray-300 px-4 py-2">$0.32–$0.94</td>
          </tr>
          <tr>
            <td class="border border-gray-300 px-4 py-2">Latency per action</td>
            <td class="border border-gray-300 px-4 py-2">2–5 seconds</td>
            <td class="border border-gray-300 px-4 py-2">10–50ms</td>
          </tr>
          <tr>
            <td class="border border-gray-300 px-4 py-2">Total time</td>
            <td class="border border-gray-300 px-4 py-2">3–8 minutes</td>
            <td class="border border-gray-300 px-4 py-2">1–5 seconds</td>
          </tr>
        </tbody>
      </table>

      <p class="mb-4 leading-relaxed">Optimization strategy: cache UI elements between actions and route simple interactions directly to the grounding model. UI state changes slowly—most elements remain at fixed coordinates across consecutive actions.</p>

      <h3 class="text-xl font-semibold mt-8 mb-4">Training</h3>

      <p class="mb-4 leading-relaxed">The grounding model is trained via GRPO (Group Relative Policy Optimization) with binary rewards:</p>

      <div class=" my-6 bg-gray-50 p-4 border border-gray-200 rounded-lg text-center">$
R(s, a, \hat{c}) = \begin{cases} 
1 & \text{if } \|\hat{c} - c_{\text{true}}\|_2 < \tau \\
0 & \text{otherwise}
\end{cases}
$</div>

      <p class="mb-4 leading-relaxed">where <span class="math-inline">$\hat{c}$</span> is the predicted coordinate, <span class="math-inline">$c_{\text{true}}$</span> is the ground truth, and <span class="math-inline">$\tau$</span> is the hit threshold.</p>

      <p class="mb-4 leading-relaxed">Training uses trajectory augmentation: one recorded workflow generates multiple training samples by varying UI states and timing. For a trajectory of length <span class="math-inline">$n$</span>, we extract <span class="math-inline">$O(n^2)$</span> sub-trajectories as training data.</p>

      <h3 class="text-xl font-semibold mt-8 mb-4">Adaptive Routing</h3>

      <p class="mb-4 leading-relaxed">For simple UIs, the grounding model executes directly without planning. We route to the planner only when confidence is low:</p>

      <div class=" my-6 bg-gray-50 p-4 border border-gray-200 rounded-lg text-center">$
\text{use\_planner} = \begin{cases} 
\text{true} & \text{if } H(p_{\text{ground}}) > \theta \text{ or } \max(p_{\text{ground}}) < \gamma \\
\text{false} & \text{otherwise}
\end{cases}
$</div>

      <p class="mb-4 leading-relaxed">where <span class="math-inline">$H(p)$</span> is the entropy of the grounding model's coordinate distribution, <span class="math-inline">$\theta$</span> is the entropy threshold, and <span class="math-inline">$\gamma$</span> is the confidence threshold.</p>

      <p class="mb-4 leading-relaxed">This achieves ~50ms latency on simple actions (A100), escalating to 2-5s only for ambiguous cases.</p>

      <h3 class="text-xl font-semibold mt-8 mb-4">Future Work</h3>

      <p class="mb-4 leading-relaxed">Current implementation processes discrete states. Moving to streaming would enable continuous perception-action loops at 5-10 Hz, handling dynamic interactions (drag, hover, scroll) more naturally.</p>

      <p class="mb-4 leading-relaxed">For repeated workflows, policy distillation can compile trajectories into specialized models:</p>

      <div class=" my-6 bg-gray-50 p-4 border border-gray-200 rounded-lg text-center">$
\pi_{\text{task}}(s) = \arg\min_{\pi} \mathbb{E}_{s \sim \mathcal{D}_{\text{task}}} \left[ \text{KL}(\pi(s) \| \pi_{\text{plan}}(s)) \right]
$</div>

      <p class="mb-4 leading-relaxed">This converts the planner from runtime dependency to training-time teacher, enabling local execution of routine tasks.</p>

      <h3 class="text-xl font-semibold mt-8 mb-4">Related Work</h3>

      <div class="text-xs text-gray-600 leading-relaxed">
        <p class="mb-2">He, Y., Jin, J., & Liu, P. (2025). <a href="https://gair-nlp.github.io/PC-Agent-E/" target="_blank" rel="noopener noreferrer" class="underline text-gray-700 hover:text-gray-900">Efficient Agent Training for Computer Use</a>. <em>arXiv preprint arXiv:2505.13909</em>.</p>
        <p class="mb-2">Yang, Y., Li, D., Dai, Y., Yang, Y., Luo, Z., Zhao, Z., Hu, Z., Huang, J., Saha, A., Chen, Z., Xu, R., Pan, L., Xiong, C., & Li, J. (2025). <a href="https://arxiv.org/abs/2507.05791" target="_blank" rel="noopener noreferrer" class="underline text-gray-700 hover:text-gray-900">GTA1: GUI Test-time Scaling Agent</a>. <em>arXiv preprint arXiv:2507.05791</em>.</p>
      </div>

    </article>

    <div class="flex items-center justify-between mt-8 pt-8 border-t border-gray-200">
      <div class="text-sm text-gray-600">
        Written by <a href="/" class="underline hover:text-gray-900">Alex Hamidi</a>
      </div>
      <div class="flex gap-4 text-sm">
        <a href="https://twitter.com/ahamidi_" class="text-gray-600 hover:text-gray-900 underline">Twitter</a>
        <a href="https://github.com/alexhamidi/" class="text-gray-600 hover:text-gray-900 underline">GitHub</a>
      </div>
    </div>

  </div>

</body>

</html>